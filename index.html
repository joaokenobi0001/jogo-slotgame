<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Slot Machine - A Ru√≠na do Jogador</title>
    <link rel="stylesheet" href="SlotMachine.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
            color: #333;
            line-height: 1.6;
            min-height: 100vh;
        }
        
        .header {
            background: linear-gradient(135deg, #2c3e50, #4a6491);
            color: white;
            text-align: center;
            padding: 25px 20px;
            border-bottom: 6px solid #f1c40f;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);
        }
        
        .header h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.5);
        }
        
        .header p {
            font-size: 1.2rem;
            max-width: 800px;
            margin: 0 auto;
            opacity: 0.9;
        }
        
        .concept-explanation {
            max-width: 1200px;
            margin: 30px auto;
            padding: 25px;
            background: white;
            border-radius: 15px;
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.15);
            border-left: 6px solid #e74c3c;
        }
        
        .concept-explanation h2 {
            color: #2c3e50;
            margin-bottom: 20px;
            font-size: 1.8rem;
            border-bottom: 2px solid #ecf0f1;
            padding-bottom: 10px;
        }
        
        .concept-explanation p {
            margin-bottom: 15px;
            font-size: 1.1rem;
        }
        
        .math-formula {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 10px;
            margin: 20px 0;
            border: 1px solid #e9ecef;
            font-family: 'Courier New', monospace;
            font-size: 1.2rem;
            text-align: center;
            color: #2c3e50;
        }
        
        .warning-box {
            background: linear-gradient(135deg, #ffeaa7, #fab1a0);
            padding: 20px;
            border-radius: 10px;
            margin-top: 20px;
            border: 2px solid #e74c3c;
            text-align: center;
            font-weight: bold;
        }
        
        .footer {
            text-align: center;
            padding: 25px;
            background: #2c3e50;
            color: white;
            margin-top: 40px;
            border-top: 4px solid #f1c40f;
        }
        
        .footer p {
            margin-bottom: 10px;
            opacity: 0.9;
        }
        
        .footer a {
            color: #f1c40f;
            text-decoration: none;
        }
        
        .footer a:hover {
            text-decoration: underline;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 0 20px;
        }
        
        .game-title {
            text-align: center;
            color: white;
            margin: 25px 0;
            font-size: 2rem;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.5);
        }
        
        @media (max-width: 768px) {
            .header h1 {
                font-size: 2rem;
            }
            
            .header p {
                font-size: 1rem;
            }
            
            .concept-explanation {
                padding: 20px;
                margin: 20px;
            }
            
            .concept-explanation h2 {
                font-size: 1.5rem;
            }
            
            .game-title {
                font-size: 1.8rem;
            }
        }
        
        @media (max-width: 480px) {
            .header h1 {
                font-size: 1.7rem;
            }
            
            .concept-explanation {
                padding: 15px;
                margin: 15px;
            }
            
            .math-formula {
                font-size: 1rem;
                padding: 15px;
            }
        }
        
        .stats-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }
        
        .stat-box {
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
            text-align: center;
        }
        
        .stat-value {
            font-size: 2rem;
            font-weight: bold;
            color: #2c3e50;
            margin: 10px 0;
        }
        
        .stat-label {
            color: #7f8c8d;
            font-size: 0.9rem;
        }
    </style>
</head>
<body>
    <header class="header">
        <div class="container">
            <h1>Slot Machine - A Ru√≠na do Jogador</h1>
            <p>Uma demonstra√ß√£o interativa do conceito matem√°tico que mostra por que os cassinos sempre ganham no longo prazo</p>
        </div>
    </header>
    
    <section class="concept-explanation container">
        <h2>O Conceito da "Ru√≠na do Jogador"</h2>
        <p>A "Ru√≠na do Jogador" √© um teorema da teoria da probabilidade que demonstra que um jogador com recursos finitos, jogando contra um oponente com recursos infinitos (como um cassino), eventualmente ir√° √† fal√™ncia, mesmo em um jogo justo.</p>
        
        <p>Este slot machine demonstra esse conceito atrav√©s de probabilidades cuidadosamente calculadas que sempre favorecem a "casa" no longo prazo.</p>
        
        <div class="math-formula">
            Expectativa Matem√°tica (EV) = ‚àë(Probabilidade √ó Multiplicador) - 1 = -0.15
        </div>
        
        <p>Isso significa que para cada R$1,00 apostado, voc√™ pode esperar perder R$0,15 em m√©dia ao longo de muitas jogadas. Quanto mais voc√™ joga, mais a lei dos grandes n√∫meros se manifesta, e mais perto voc√™ fica desse resultado esperado.</p>
        
        <div class="stats-container">
            <div class="stat-box">
                <div class="stat-label">Taxa de Vit√≥ria Te√≥rica</div>
                <div class="stat-value" id="theoreticalWinRate">20%</div>
                <div class="stat-label">(com base nas probabilidades)</div>
            </div>
            <div class="stat-box">
                <div class="stat-label">Taxa de Vit√≥ria Real</div>
                <div class="stat-value" id="actualWinRate">0%</div>
                <div class="stat-label">(com base nas suas jogadas)</div>
            </div>
            <div class="stat-box">
                <div class="stat-label">Diferen√ßa</div>
                <div class="stat-value" id="winRateDiff">0%</div>
                <div class="stat-label">(Real vs Te√≥rica)</div>
            </div>
        </div>
        
        <div class="warning-box">
            ATEN√á√ÉO: Este √© um projeto estritamente educativo. O objetivo √© demonstrar conceitos matem√°ticos, n√£o promover jogos de azar.
        </div>
    </section>
    
    <h2 class="game-title">Jogue e Aprenda com a Simula√ß√£o</h2>
    
    <div class="slot-machine-container container">
        <div class="slot-main-content">
            <div class="slot-machine">
                <div class="reels-container">
                    <div class="payline"></div>
                    <div class="reel" id="reel1">
                        <div class="reel-symbol" id="symbol1">üçí</div>
                    </div>
                    <div class="reel" id="reel2">
                        <div class="reel-symbol" id="symbol2">üçã</div>
                    </div>
                    <div class="reel" id="reel3">
                        <div class="reel-symbol" id="symbol3">üçä</div>
                    </div>
                </div>
                
                <div class="slot-controls">
                    <div class="betting-panel">
                        <h3>Fa√ßa sua aposta</h3>
                        <input type="number" id="betAmount" min="1" max="100" value="10" placeholder="Valor da aposta">
                    </div>
                    
                    <div class="buttons-container">
                        <button class="spin-button" id="spinButton">
                            <i class="fas fa-play"></i> Girar
                        </button>
                        <button class="spin-button reset" id="resetButton">
                            <i class="fas fa-redo"></i> Reiniciar
                        </button>
                        <button class="spin-button" id="autoSpinButton">
                            <i class="fas fa-sync-alt"></i> 10 Giros Autom√°ticos
                        </button>
                        <button class="spin-button" id="quick100Button">
                            <i class="fas fa-forward"></i> 100 Giros R√°pidos
                        </button>
                    </div>
                    
                    <div class="balance-info">
                        <h3>Saldo: R$ <span id="balance">1000</span></h3>
                        <div class="win-display" id="winDisplay" style="display: none;">
                            +R$ <span id="winAmount">0</span>
                        </div>
                    </div>
                    
                    <div class="result-message" id="resultMessage" style="display: none;">
                    </div>
                    
                    <div class="probability-info">
                        <h4>Expectativa Matem√°tica: -15% por aposta</h4>
                        <p>Quanto mais voc√™ joga, mais perto chega deste resultado</p>
                    </div>
                </div>
            </div>
            
            <div class="probabilities-panel">
                <h4>Probabilidades e Multiplicadores</h4>
                <div class="probability-item">
                    <div class="symbol">üçí Cereja</div>
                    <div class="multiplier">2√ó</div>
                    <div class="probability">35% de chance</div>
                </div>
                <div class="probability-item">
                    <div class="symbol">üçã Lim√£o</div>
                    <div class="multiplier">3√ó</div>
                    <div class="probability">25% de chance</div>
                </div>
                <div class="probability-item">
                    <div class="symbol">üçä Laranja</div>
                    <div class="multiplier">4√ó</div>
                    <div class="probability">20% de chance</div>
                </div>
                <div class="probability-item">
                    <div class="symbol">üíé Diamante</div>
                    <div class="multiplier">8√ó</div>
                    <div class="probability">15% de chance</div>
                </div>
                <div class="probability-item">
                    <div class="symbol">7Ô∏è‚É£ Sete</div>
                    <div class="multiplier">16√ó</div>
                    <div class="probability">5% de chance</div>
                </div>
            </div>
        </div>
        
        <div class="slot-chart-container">
            <div class="chart-section">
                <h4>Evolu√ß√£o do Saldo</h4>
                <canvas id="balanceChart"></canvas>
            </div>
            
            <div class="chart-section">
                <h4>Probabilidade de Vit√≥ria por Jogada</h4>
                <canvas id="probabilityChart"></canvas>
            </div>
            
            <div class="chart-section">
                <h4>Converg√™ncia para a Expectativa Te√≥rica</h4>
                <canvas id="convergenceChart"></canvas>
            </div>
            
            <div class="educational-note">
                <h4><i class="fas fa-graduation-cap"></i> Li√ß√£o Matem√°tica</h4>
                <p><strong>Lei dos Grandes N√∫meros:</strong> Em um pequeno n√∫mero de jogadas, voc√™ pode ter sorte. Mas √† medida que o n√∫mero de jogadas aumenta, os resultados convergem para a expectativa matem√°tica (-15%).</p>
                <p><strong>Gest√£o de Risco:</strong> Mesmo come√ßando com um saldo alto, a probabilidade de perder tudo aumenta com cada aposta quando as chances n√£o s√£o favor√°veis.</p>
            </div>
        </div>
    </div>
    
    <footer class="footer">
        <div class="container">
            <p>Slot Machine - A Ru√≠na do Jogador | Projeto Educacional</p>
            <p>Desenvolvido para demonstrar conceitos de probabilidade e estat√≠stica</p>
            <p>¬© 2023 - Todos os direitos reservados | <a href="#" id="showMathDetails">Detalhes Matem√°ticos</a></p>
        </div>
    </footer>
    
    <script>
        const reel1 = document.getElementById('reel1');
        const reel2 = document.getElementById('reel2');
        const reel3 = document.getElementById('reel3');
        const symbol1 = document.getElementById('symbol1');
        const symbol2 = document.getElementById('symbol2');
        const symbol3 = document.getElementById('symbol3');
        const spinButton = document.getElementById('spinButton');
        const resetButton = document.getElementById('resetButton');
        const autoSpinButton = document.getElementById('autoSpinButton');
        const quick100Button = document.getElementById('quick100Button');
        const betAmountInput = document.getElementById('betAmount');
        const balanceDisplay = document.getElementById('balance');
        const winDisplay = document.getElementById('winDisplay');
        const winAmountDisplay = document.getElementById('winAmount');
        const resultMessage = document.getElementById('resultMessage');
        const theoreticalWinRate = document.getElementById('theoreticalWinRate');
        const actualWinRate = document.getElementById('actualWinRate');
        const winRateDiff = document.getElementById('winRateDiff');
        
        let balance = 1000;
        let isSpinning = false;
        let spinCount = 0;
        let winCount = 0;
        let resultsHistory = [];
        let balanceHistory = [balance];
        let winProbabilityHistory = [];
        let convergenceHistory = [];
        
        const symbols = [
            { emoji: "üçí", name: "Cereja", multiplier: 2, probability: 0.35 },
            { emoji: "üçã", name: "Lim√£o", multiplier: 3, probability: 0.25 },
            { emoji: "üçä", name: "Laranja", multiplier: 4, probability: 0.20 },
            { emoji: "üíé", name: "Diamante", multiplier: 8, probability: 0.15 },
            { emoji: "7Ô∏è‚É£", name: "Sete", multiplier: 16, probability: 0.05 }
        ];
        
        const theoreticalProbability = 0.20;
        
        let balanceChart, probabilityChart, convergenceChart;
        
        function initializeCharts() {
            const balanceCtx = document.getElementById('balanceChart').getContext('2d');
            balanceChart = new Chart(balanceCtx, {
                type: 'line',
                data: {
                    labels: ['In√≠cio'],
                    datasets: [{
                        label: 'Saldo (R$)',
                        data: [balance],
                        borderColor: '#3498db',
                        backgroundColor: 'rgba(52, 152, 219, 0.1)',
                        borderWidth: 2,
                        fill: true,
                        tension: 0.4
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: {
                            beginAtZero: true,
                            grid: {
                                color: 'rgba(0, 0, 0, 0.1)'
                            }
                        },
                        x: {
                            grid: {
                                color: 'rgba(0, 0, 0, 0.1)'
                            }
                        }
                    },
                    plugins: {
                        legend: {
                            display: true,
                            position: 'top'
                        }
                    }
                }
            });
            
            const probabilityCtx = document.getElementById('probabilityChart').getContext('2d');
            probabilityChart = new Chart(probabilityCtx, {
                type: 'line',
                data: {
                    labels: ['In√≠cio'],
                    datasets: [
                        {
                            label: 'Probabilidade Real de Vit√≥ria',
                            data: [0],
                            borderColor: '#e74c3c',
                            backgroundColor: 'rgba(231, 76, 60, 0.1)',
                            borderWidth: 2,
                            fill: true,
                            tension: 0.4
                        },
                        {
                            label: 'Probabilidade Te√≥rica (20%)',
                            data: [20],
                            borderColor: '#2ecc71',
                            backgroundColor: 'rgba(46, 204, 113, 0.1)',
                            borderWidth: 2,
                            borderDash: [5, 5],
                            fill: false,
                            tension: 0
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: {
                            beginAtZero: true,
                            max: 100,
                            title: {
                                display: true,
                                text: 'Probabilidade (%)'
                            },
                            grid: {
                                color: 'rgba(0, 0, 0, 0.1)'
                            }
                        },
                        x: {
                            title: {
                                display: true,
                                text: 'N√∫mero de Jogadas'
                            },
                            grid: {
                                color: 'rgba(0, 0, 0, 0.1)'
                            }
                        }
                    },
                    plugins: {
                        legend: {
                            display: true,
                            position: 'top'
                        }
                    }
                }
            });
            
            const convergenceCtx = document.getElementById('convergenceChart').getContext('2d');
            convergenceChart = new Chart(convergenceCtx, {
                type: 'line',
                data: {
                    labels: ['In√≠cio'],
                    datasets: [{
                        label: 'Diferen√ßa entre Probabilidade Real e Te√≥rica',
                        data: [100],
                        borderColor: '#9b59b6',
                        backgroundColor: 'rgba(155, 89, 182, 0.1)',
                        borderWidth: 2,
                        fill: true,
                        tension: 0.4
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: {
                            beginAtZero: true,
                            max: 100,
                            title: {
                                display: true,
                                text: 'Diferen√ßa (%)'
                            },
                            grid: {
                                color: 'rgba(0, 0, 0, 0.1)'
                            }
                        },
                        x: {
                            title: {
                                display: true,
                                text: 'N√∫mero de Jogadas'
                            },
                            grid: {
                                color: 'rgba(0, 0, 0, 0.1)'
                            }
                        }
                    },
                    plugins: {
                        legend: {
                            display: true,
                            position: 'top'
                        },
                        annotation: {
                            annotations: {
                                line1: {
                                    type: 'line',
                                    yMin: 10,
                                    yMax: 10,
                                    borderColor: '#f39c12',
                                    borderWidth: 2,
                                    borderDash: [5, 5],
                                    label: {
                                        content: 'Zona de Converg√™ncia',
                                        enabled: true,
                                        position: 'end'
                                    }
                                }
                            }
                        }
                    }
                }
            });
        }
        
        function getRandomSymbol() {
            const rand = Math.random();
            let cumulativeProbability = 0;
            
            for (const symbol of symbols) {
                cumulativeProbability += symbol.probability;
                if (rand <= cumulativeProbability) {
                    return symbol;
                }
            }
            
            return symbols[0];
        }
        
        async function spinReels() {
            if (isSpinning) return;
            
            const betAmount = parseInt(betAmountInput.value);
            
            if (isNaN(betAmount) || betAmount < 1) {
                showResultMessage("Por favor, insira uma aposta v√°lida (m√≠nimo R$1)", "error");
                return;
            }
            
            if (betAmount > balance) {
                showResultMessage("Saldo insuficiente para esta aposta", "error");
                return;
            }
            
            if (betAmount > 100) {
                showResultMessage("Aposta m√°xima √© R$100", "error");
                betAmountInput.value = 100;
                return;
            }
            
            balance -= betAmount;
            updateBalance();
            
            isSpinning = true;
            spinButton.disabled = true;
            autoSpinButton.disabled = true;
            quick100Button.disabled = true;
            betAmountInput.disabled = true;
            
            reel1.classList.add('spinning');
            reel2.classList.add('spinning');
            reel3.classList.add('spinning');
            
            const spinDuration = 1500 + Math.random() * 1000;
            
            await new Promise(resolve => setTimeout(resolve, spinDuration));
            
            const symbol1Data = getRandomSymbol();
            const symbol2Data = getRandomSymbol();
            const symbol3Data = getRandomSymbol();
            
            symbol1.textContent = symbol1Data.emoji;
            symbol2.textContent = symbol2Data.emoji;
            symbol3.textContent = symbol3Data.emoji;
            
            reel1.classList.remove('spinning');
            reel2.classList.remove('spinning');
            reel3.classList.remove('spinning');
            
            await new Promise(resolve => setTimeout(resolve, 300));
            
            const isWin = symbol1Data === symbol2Data && symbol2Data === symbol3Data;
            let winAmount = 0;
            
            if (isWin) {
                winAmount = betAmount * symbol1Data.multiplier;
                balance += winAmount;
                winCount++;
                
                showWin(winAmount);
                showResultMessage(`Parab√©ns! Tr√™s ${symbol1Data.name} - Ganhou ${symbol1Data.multiplier}x (R$${winAmount})`, "win");
                
                reel1.classList.add('win-animation');
                reel2.classList.add('win-animation');
                reel3.classList.add('win-animation');
                
                setTimeout(() => {
                    reel1.classList.remove('win-animation');
                    reel2.classList.remove('win-animation');
                    reel3.classList.remove('win-animation');
                }, 2000);
            } else {
                showResultMessage("N√£o foi dessa vez. Tente novamente!", "loss");
            }
            
            spinCount++;
            
            const currentWinProbability = spinCount > 0 ? (winCount / spinCount) * 100 : 0;
            const difference = Math.abs(currentWinProbability - (theoreticalProbability * 100));
            
            winProbabilityHistory.push(currentWinProbability);
            convergenceHistory.push(difference);
            
            updateWinRateStats(currentWinProbability, difference);
            updateCharts();
            
            updateBalance();
            
            if (balance <= 0) {
                showResultMessage("FAL√äNCIA! Voc√™ perdeu todo seu dinheiro. Esta √© a 'Ru√≠na do Jogador' em a√ß√£o!", "bankrupt");
                spinButton.disabled = true;
                autoSpinButton.disabled = true;
                quick100Button.disabled = true;
            }
            
            isSpinning = false;
            spinButton.disabled = false;
            autoSpinButton.disabled = false;
            quick100Button.disabled = false;
            betAmountInput.disabled = false;
        }
        
        function updateWinRateStats(currentProbability, difference) {
            const theoreticalPercent = (theoreticalProbability * 100).toFixed(1);
            const actualPercent = currentProbability.toFixed(1);
            const diffPercent = difference.toFixed(1);
            
            theoreticalWinRate.textContent = `${theoreticalPercent}%`;
            actualWinRate.textContent = `${actualPercent}%`;
            winRateDiff.textContent = `${diffPercent}%`;
            
            if (difference < 5) {
                winRateDiff.style.color = '#2ecc71';
            } else if (difference < 10) {
                winRateDiff.style.color = '#f39c12';
            } else {
                winRateDiff.style.color = '#e74c3c';
            }
        }
        
        function showWin(amount) {
            winAmountDisplay.textContent = amount;
            winDisplay.style.display = 'block';
            
            setTimeout(() => {
                winDisplay.style.display = 'none';
            }, 3000);
        }
        
        function showResultMessage(message, type) {
            resultMessage.textContent = message;
            resultMessage.style.display = 'block';
            
            if (type === "win") {
                resultMessage.style.color = "#2ecc71";
                resultMessage.style.borderColor = "#2ecc71";
                resultMessage.style.background = "rgba(46, 204, 113, 0.1)";
            } else if (type === "loss") {
                resultMessage.style.color = "#e74c3c";
                resultMessage.style.borderColor = "#e74c3c";
                resultMessage.style.background = "rgba(231, 76, 60, 0.1)";
            } else if (type === "error") {
                resultMessage.style.color = "#f39c12";
                resultMessage.style.borderColor = "#f39c12";
                resultMessage.style.background = "rgba(243, 156, 18, 0.1)";
            } else if (type === "bankrupt") {
                resultMessage.style.color = "#c0392b";
                resultMessage.style.borderColor = "#c0392b";
                resultMessage.style.background = "rgba(192, 57, 43, 0.1)";
                resultMessage.style.animation = "pulse 0.5s ease-in-out infinite";
            }
            
            if (type !== "bankrupt") {
                setTimeout(() => {
                    resultMessage.style.display = 'none';
                }, 5000);
            }
        }
        
        function updateBalance() {
            balanceDisplay.textContent = balance;
            balanceHistory.push(balance);
        }
        
        function updateCharts() {
            balanceChart.data.labels.push(`Jogada ${spinCount}`);
            balanceChart.data.datasets[0].data.push(balance);
            balanceChart.update();
            
            const labels = Array.from({length: spinCount + 1}, (_, i) => i === 0 ? 'In√≠cio' : i);
            
            probabilityChart.data.labels = labels;
            probabilityChart.data.datasets[0].data = [0, ...winProbabilityHistory];
            probabilityChart.data.datasets[1].data = Array(spinCount + 1).fill(theoreticalProbability * 100);
            probabilityChart.update();
            
            convergenceChart.data.labels = labels;
            convergenceChart.data.datasets[0].data = [100, ...convergenceHistory];
            convergenceChart.update();
        }
        
        function resetGame() {
            balance = 1000;
            spinCount = 0;
            winCount = 0;
            resultsHistory = [];
            balanceHistory = [balance];
            winProbabilityHistory = [];
            convergenceHistory = [];
            
            updateBalance();
            
            symbol1.textContent = "üçí";
            symbol2.textContent = "üçã";
            symbol3.textContent = "üçä";
            
            winDisplay.style.display = 'none';
            resultMessage.style.display = 'none';
            
            spinButton.disabled = false;
            autoSpinButton.disabled = false;
            quick100Button.disabled = false;
            betAmountInput.disabled = false;
            
            updateWinRateStats(0, 100);
            
            balanceChart.data.labels = ['In√≠cio'];
            balanceChart.data.datasets[0].data = [balance];
            balanceChart.update();
            
            probabilityChart.data.labels = ['In√≠cio'];
            probabilityChart.data.datasets[0].data = [0];
            probabilityChart.data.datasets[1].data = [20];
            probabilityChart.update();
            
            convergenceChart.data.labels = ['In√≠cio'];
            convergenceChart.data.datasets[0].data = [100];
            convergenceChart.update();
            
            showResultMessage("Jogo reiniciado com saldo inicial de R$1000", "info");
        }
        
        async function autoSpin(spins = 10) {
            if (isSpinning) return;
            
            autoSpinButton.disabled = true;
            spinButton.disabled = true;
            quick100Button.disabled = true;
            
            for (let i = 0; i < spins; i++) {
                if (balance <= 0) break;
                
                await spinReels();
                
                if (i < spins - 1 && balance > 0) {
                    await new Promise(resolve => setTimeout(resolve, 300));
                }
            }
            
            autoSpinButton.disabled = false;
            spinButton.disabled = false;
            quick100Button.disabled = false;
            
            showResultMessage(`Conclu√≠dos ${spins} giros autom√°ticos. Saldo final: R$${balance}`, "info");
        }
        
        async function quick100Spins() {
            if (isSpinning) return;
            
            quick100Button.disabled = true;
            spinButton.disabled = true;
            autoSpinButton.disabled = true;
            
            const initialBalance = balance;
            const initialSpins = spinCount;
            
            for (let i = 0; i < 100; i++) {
                if (balance <= 0) break;
                
                const betAmount = parseInt(betAmountInput.value);
                if (betAmount > balance) break;
                
                balance -= betAmount;
                
                const symbol1Data = getRandomSymbol();
                const symbol2Data = getRandomSymbol();
                const symbol3Data = getRandomSymbol();
                
                const isWin = symbol1Data === symbol2Data && symbol2Data === symbol3Data;
                
                if (isWin) {
                    const winAmount = betAmount * symbol1Data.multiplier;
                    balance += winAmount;
                    winCount++;
                }
                
                spinCount++;
                
                const currentWinProbability = (winCount / spinCount) * 100;
                const difference = Math.abs(currentWinProbability - (theoreticalProbability * 100));
                
                winProbabilityHistory.push(currentWinProbability);
                convergenceHistory.push(difference);
                balanceHistory.push(balance);
            }
            
            updateBalance();
            updateWinRateStats((winCount / spinCount) * 100, Math.abs((winCount / spinCount * 100) - (theoreticalProbability * 100)));
            updateCharts();
            
            const spinsDone = spinCount - initialSpins;
            const balanceChange = balance - initialBalance;
            
            quick100Button.disabled = false;
            spinButton.disabled = false;
            autoSpinButton.disabled = false;
            
            showResultMessage(`${spinsDone} giros r√°pidos conclu√≠dos. Saldo: R$${balance} (${balanceChange >= 0 ? '+' : ''}R$${balanceChange})`, "info");
            
            if (balance <= 0) {
                showResultMessage("FAL√äNCIA! Voc√™ perdeu todo seu dinheiro. Esta √© a 'Ru√≠na do Jogador' em a√ß√£o!", "bankrupt");
                spinButton.disabled = true;
                autoSpinButton.disabled = true;
                quick100Button.disabled = true;
            }
        }
        
        function showMathDetails() {
            const details = `
                Detalhes Matem√°ticos da Ru√≠na do Jogador

                Expectativa Matem√°tica (EV): -15% por aposta

                C√°lculo: EV = (0.35√ó2 + 0.25√ó3 + 0.20√ó4 + 0.15√ó8 + 0.05√ó16) - 1 = -0.15

                Interpreta√ß√£o: Para cada R$1 apostado, voc√™ perde R$0.15 em m√©dia.

                Probabilidade Te√≥rica de Vit√≥ria: 20%
                - Cereja (2x): 35% √ó 35% √ó 35% = 4.29%
                - Lim√£o (3x): 25% √ó 25% √ó 25% = 1.56%
                - Laranja (4x): 20% √ó 20% √ó 20% = 0.80%
                - Diamante (8x): 15% √ó 15% √ó 15% = 0.34%
                - Sete (16x): 5% √ó 5% √ó 5% = 0.01%
                Total: 4.29% + 1.56% + 0.80% + 0.34% + 0.01% = 7.00%

                Lei dos Grandes N√∫meros: Com poucas jogadas, resultados variam. Com muitas jogadas, resultados convergem para a expectativa.

                Probabilidade de Fal√™ncia: Em jogos com EV negativo, a probabilidade de perder tudo aumenta com o n√∫mero de apostas.
            `;
            
            alert(details);
        }
        
        spinButton.addEventListener('click', spinReels);
        resetButton.addEventListener('click', resetGame);
        autoSpinButton.addEventListener('click', () => autoSpin(10));
        quick100Button.addEventListener('click', quick100Spins);
        
        betAmountInput.addEventListener('change', function() {
            let value = parseInt(this.value);
            
            if (isNaN(value) || value < 1) {
                this.value = 1;
            } else if (value > 100) {
                this.value = 100;
            }
        });
        
        document.getElementById('showMathDetails').addEventListener('click', function(e) {
            e.preventDefault();
            showMathDetails();
        });
        
        window.onload = function() {
            initializeCharts();
            showResultMessage("Bem-vindo! Defina sua aposta e clique em Girar. Observe como a probabilidade de vit√≥ria converge para 20%.", "info");
        };
    </script>
</body>
</html>